<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>Umami & Aroma Rewards</title>

<style>
body{
margin:0;
min-height:100vh;
display:flex;
justify-content:center;
align-items:center;
background:#1c1c1c;
font-family:Arial;
}

.card{
background:#fff;
padding:40px;
border-radius:18px;
width:95%;
max-width:420px;
text-align:center;
}

h1{margin-top:0}

input,button{
width:100%;
padding:14px;
font-size:18px;
margin-top:10px;
border-radius:8px;
}

button{
background:#d4af37;
border:none;
font-weight:bold;
}

button:disabled{background:#aaa;}

#slot{font-size:48px;margin:25px 0}
#result{font-size:26px;color:green}
#code{font-size:20px}

.stamps{
display:grid;
grid-template-columns:repeat(5,1fr);
gap:12px;
margin-top:15px;
}

.stamp{
width:50px;
height:50px;
border-radius:50%;
border:2px dashed #999;
}

.stamp.filled{
background:radial-gradient(circle,#ffd700,#b8860b);
}

.msg{color:red;margin-top:10px}
</style>
</head>

<body>

<div class="card">

<h1>Umami & Aroma Rewards</h1>

<div id="step1">
<input id="phone" placeholder="Enter Mobile Number" maxlength="10">
<button id="continueBtn" onclick="submitPhone()">Continue</button>
</div>

<div id="step2" style="display:none">

<button id="playBtn" onclick="startGame()">Get My Reward</button>

<div id="slot">ðŸŽ°</div>
<div id="result"></div>
<div id="code"></div>

<p>
Do not refresh or leave the screen.<br>
Take a screenshot and share it while placing the order.
</p>

<h3>Loyalty Card</h3>
<div class="stamps" id="stamps"></div>
<div id="progress"></div>

</div>

<div class="msg" id="msg"></div>

</div>

<audio id="sound" src="win-sound.mp3"></audio>

<script>

const SCRIPT_URL="https://script.google.com/macros/s/AKfycbwGs4aNFvnstAb2ZIv2x1wuJN-IFtLwmQ0lWUVmVSUtoGdsUMBgW973QC0UNAgQD_gV/exec";

let phone="";
let locked=false;

/* REWARDS */

const COMMON=[
{t:"10% OFF",c:"UA-7B3M9Q"},
{t:"11% OFF",c:"UA-K8F2A6"},
{t:"12% OFF",c:"UA-9Q4L2X"},
{t:"13% OFF",c:"UA-M5A7C8"},
{t:"14% OFF",c:"UA-2XQ9F4"},
{t:"15% OFF",c:"UA-8L6K3M"},
{t:"ðŸ¹ Free Iced Tea",c:"UA-T9F3KQ"},
{t:"â˜• Free Iced Americano",c:"UA-A7M2QX"},
{t:"Buy Burger + Fries Free",c:"UA-BF7Q2A"},
{t:"Buy Sandwich + Soft Drink",c:"UA-SD9M2X"},
{t:"Buy 2 Beverages Get 1",c:"UA-B2G1Q"}
];

const RARE=[
{t:"16% OFF",c:"UA-F4Q7A9"},
{t:"17% OFF",c:"UA-6C2X8L"},
{t:"18% OFF",c:"UA-Q9M5F2"},
{t:"19% OFF",c:"UA-A7L4K6"},
{t:"20% OFF",c:"UA-3F8Q9X"}
];

const ULTRA=[
{t:"ðŸ Buy 1 Get 1 Free Pasta",c:"UA-PB7X2L"}
];

function submitPhone(){

if(locked) return;

phone=document.getElementById("phone").value;
if(phone.length!=10) return alert("Enter valid mobile");

locked=true;
document.getElementById("continueBtn").disabled=true;
document.getElementById("continueBtn").innerText="Checking...";

fetch(SCRIPT_URL,{
method:"POST",
body:new URLSearchParams({phone})
})
.then(r=>r.text())
.then(res=>{

const parts=res.split("|");

if(parts[0]=="ALREADY"){
document.getElementById("msg").innerText=
"You already claimed todayâ€™s reward. Come back tomorrow.";
renderStamps(parts[1]);
}

if(parts[0]=="OK"){
document.getElementById("step1").style.display="none";
document.getElementById("step2").style.display="block";
renderStamps(parts[1]);
}

});
}

/* GAME */

function startGame(){

document.getElementById("playBtn").disabled=true;

let spins=20;

let i=setInterval(()=>{
document.getElementById("slot").innerText=
Math.floor(Math.random()*50)+"%";
spins--;
if(spins==0){
clearInterval(i);
showReward();
}
},80);
}

function showReward(){

let roll=Math.random()*100;
let r;

if(roll<60) r=random(COMMON);
else if(roll<90) r=random(RARE);
else r=random(ULTRA);

document.getElementById("slot").innerText=r.t;
document.getElementById("result").innerText="YOU WON!";
document.getElementById("code").innerText=r.c;
document.getElementById("sound").play();
}

function random(arr){
return arr[Math.floor(Math.random()*arr.length)];
}

/* STAMPS */

function renderStamps(count){

count=parseInt(count);
const wrap=document.getElementById("stamps");
wrap.innerHTML="";

for(let i=1;i<=10;i++){
let d=document.createElement("div");
d.className="stamp";
if(i<=count) d.classList.add("filled");
wrap.appendChild(d);
}

document.getElementById("progress").innerText=
count+"/10 orders completed";
}

</script>

</body>
</html>

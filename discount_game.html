<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Spin & Win Reward</title>

<style>
body {
  margin: 0;
  min-height: 100vh;
  display: flex;
  justify-content: center;
  align-items: center;
  text-align: center;
  font-family: Arial, sans-serif;
  background: linear-gradient(135deg, #ffecd2, #fcb69f);
  overflow: hidden;
}

.overlay {
  background: rgba(255, 255, 255, 0.95);
  padding: 32px 28px;
  border-radius: 14px;
  max-width: 90%;
  box-shadow: 0 8px 30px rgba(0,0,0,0.2);
  z-index: 2;
}

button {
  padding: 14px 26px;
  font-size: 18px;
  cursor: pointer;
  border-radius: 8px;
  border: none;
}

button:disabled {
  background: #ccc;
  cursor: not-allowed;
}

#timer {
  font-size: 18px;
  margin-top: 15px;
  color: red;
  min-height: 22px;
}

#slot {
  font-size: 36px;
  font-weight: bold;
  margin-top: 20px;
  min-height: 50px;
}

#result {
  font-size: 22px;
  font-weight: bold;
  color: green;
  opacity: 0;
  margin-top: 10px;
  white-space: pre-line;
}

.win {
  animation: pop 0.8s ease forwards, glow 1.5s infinite;
}

@keyframes pop {
  0% { transform: scale(0.5); opacity: 0; }
  60% { transform: scale(1.3); opacity: 1; }
  100% { transform: scale(1); opacity: 1; }
}

@keyframes glow {
  0% { text-shadow: 0 0 5px gold; }
  50% { text-shadow: 0 0 20px gold; }
  100% { text-shadow: 0 0 5px gold; }
}

.confetti {
  position: fixed;
  width: 10px;
  height: 10px;
  top: -10px;
  animation: fall linear forwards;
}

@keyframes fall {
  to {
    transform: translateY(110vh) rotate(360deg);
    opacity: 0;
  }
}
</style>
</head>

<body>

<div class="overlay">
  <h2>üéâ Spin & Win Reward üéâ</h2>
  <button id="discountBtn" onclick="startGame()">Spin Now</button>
  <div id="timer"></div>
  <div id="slot">üé∞</div>
  <div id="result"></div>
  <p style="font-size:13px;margin-top:15px;">
    Valid for same-day order only<br>
    Show live screen to claim
  </p>
</div>

<audio id="winSound" preload="auto">
  <source src="win-sound.mp3" type="audio/mpeg">
</audio>

<script>

const STORAGE_KEY = "rewardPlayedDate";
const todayKey = new Date().toISOString().split("T")[0];

const NORMAL = [
{text:"10% OFF",code:"UA-7B3M9Q"},
{text:"üçπ Free Iced Tea",code:"UA-T9F3KQ"},
{text:"Buy 2 Beverages Get 1",code:"UA-B21QX"},
{text:"Buy Burger + Fries Free",code:"UA-BG7K2"},
{text:"Buy Sandwich + Drink Free",code:"UA-SD9M3"},
{text:"Get Free Fries",code:"UA-FR88Q"}
{text:"‚òï Free Iced Americano",code:"UA-A7M2QX"}
];

const RARE = [
{text:"11% OFF",code:"UA-K8F2A6"},
{text:"12% OFF",code:"UA-9Q4L2X"},
{text:"13% OFF",code:"UA-M5A7C8"},
{text:"14% OFF",code:"UA-2XQ9F4"},
{text:"15% OFF",code:"UA-F4Q7A9"}
];

const ULTRA = [
{text:"üçù Buy 1 Get 1 Pasta",code:"UA-PB7X2L"}
];

const btn = document.getElementById("discountBtn");
const timer = document.getElementById("timer");
const slot = document.getElementById("slot");
const result = document.getElementById("result");
const winSound = document.getElementById("winSound");

let confettiInterval = null;

if(localStorage.getItem(STORAGE_KEY) === todayKey){
  btn.disabled = true;
  result.style.opacity = 1;
  result.innerText = "‚ùå Already played today.\nCome back tomorrow!";
}

function startGame(){
  btn.disabled = true;

  winSound.play().then(()=>{
    winSound.pause();
    winSound.currentTime = 0;
  }).catch(()=>{});

  let timeLeft = 3;
  timer.innerText = "Spinning in " + timeLeft + "s";

  const countdown = setInterval(()=>{
    timeLeft--;

    if(timeLeft > 0){
      timer.innerText = "Spinning in " + timeLeft + "s";
    } else {
      clearInterval(countdown);
      timer.innerText = ""; // removes text
      spinSlot();
    }

  },1000);
}

function spinSlot(){
  let spins = 20;
  const interval = setInterval(()=>{
    slot.innerText = "üéÅ";
    spins--;
    if(spins === 0){
      clearInterval(interval);
      showWin();
    }
  },100);
}

function getReward(){
  const chance = Math.random();

  if(chance < 0.75){
    return NORMAL[Math.floor(Math.random()*NORMAL.length)];
  } 
  else if(chance < 0.95){
    return RARE[Math.floor(Math.random()*RARE.length)];
  } 
  else {
    return ULTRA[Math.floor(Math.random()*ULTRA.length)];
  }
}

function showWin(){
  const reward = getReward();

  localStorage.setItem(STORAGE_KEY, todayKey);

  slot.innerText = "üéâ";

  result.innerText =
    "YOU WON:\n" +
    reward.text +
    "\nCode: " + reward.code;

  result.classList.add("win");
  result.style.opacity = 1;

  winSound.currentTime = 0;
  winSound.play();

  startConfetti();

  setTimeout(()=>{
    clearInterval(confettiInterval);
    confettiInterval = null;
  },8000);
}

function startConfetti(){
  if(confettiInterval) return;

  confettiInterval = setInterval(()=>{
    for(let i=0;i<8;i++){
      const confetti = document.createElement("div");
      confetti.className = "confetti";
      confetti.style.left = Math.random()*100+"vw";
      confetti.style.backgroundColor =
        `hsl(${Math.random()*360},100%,50%)`;
      confetti.style.animationDuration =
        Math.random()*2+2+"s";
      document.body.appendChild(confetti);
      setTimeout(()=>confetti.remove(),4000);
    }
  },700);
}

</script>

</body>
</html>

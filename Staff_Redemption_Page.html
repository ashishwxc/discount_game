<!DOCTYPE html>
<html>
<head>
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>Staff Coupon Redeem</title>

<style>
body{
  font-family: Arial, sans-serif;
  background:#0f0f0f;
  color:#fff;
  text-align:center;
  padding:30px;
}

h1{
  font-size:28px;
  margin-bottom:10px;
}

.dateBox{
  background:#222;
  padding:12px;
  border-radius:10px;
  font-size:18px;
  color:gold;
  margin-bottom:25px;
}

input,button{
  width:90%;
  max-width:360px;
  font-size:22px;
  padding:14px;
  border-radius:10px;
  border:none;
  margin:10px 0;
}

button{
  background:#00c853;
  color:#000;
  font-weight:bold;
}

button:disabled{
  background:#555;
}

.msg{
  margin-top:18px;
  font-size:20px;
}
</style>
</head>

<body>

<h1>Staff Coupon Redeem</h1>

<div class="dateBox" id="todayBox"></div>

<input id="phone" placeholder="Customer Mobile Number">

<input id="code" placeholder="Coupon Code">

<button id="redeemBtn" onclick="redeem()">Redeem Coupon</button>

<div class="msg" id="msg"></div>

<script>

const SCRIPT_URL = "PASTE_YOUR_SCRIPT_DEPLOYMENT_URL";

document.getElementById("todayBox").innerText =
  "Today: " + new Date().toLocaleDateString();

let busy = false;

function redeem(){

  if(busy) return;

  const phone = document.getElementById("phone").value.trim();
  const code  = document.getElementById("code").value.trim();

  if(phone.length < 8 || code.length < 4){
    alert("Enter mobile number and coupon code");
    return;
  }

  busy = true;
  const btn = document.getElementById("redeemBtn");
  btn.disabled = true;
  btn.innerText = "Processing...";

  fetch(`${SCRIPT_URL}?action=redeemCoupon&phone=${phone}&code=${code}`)
    .then(r => r.text())
    .then(res => {

      if(res === "REDEEMED"){
        document.getElementById("msg").innerText =
          "Coupon redeemed. Loyalty stamp added.";
      }
      else if(res === "USED"){
        document.getElementById("msg").innerText =
          "This coupon has already been used.";
      }
      else{
        document.getElementById("msg").innerText =
          "Invalid coupon or error.";
      }

      busy = false;
      btn.disabled = false;
      btn.innerText = "Redeem Coupon";

    })
    .catch(()=>{
      busy = false;
      btn.disabled = false;
      btn.innerText = "Redeem Coupon";
      document.getElementById("msg").innerText =
        "Connection error. Try again.";
    });

}

</script>

</body>
</html>
